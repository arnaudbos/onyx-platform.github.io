<!DOCTYPE html>
<html>

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Logging</title>
  <meta name="description" content="Distributed, masterless, high performance, fault tolerant data processing
">

  <script>
	  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

	  ga('create', 'UA-72807409-1', 'auto');
	  ga('send', 'pageview');
  </script>

  <link rel="stylesheet" href="/css/main.css">
  <link rel="stylesheet" href="/css/lavish-bootstrap.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/cheat-sheet-style.css">
  <link rel="canonical" href="http://www.onyxplatform.org/docs/user-guide/0.8.8/logging.html">
  <link rel="alternate" type="application/rss+xml" title="Onyx" href="http://www.onyxplatform.org/feed.xml" />
</head>



  <body>
    <header class="site-header">
  <div class="container-fluid">
    <div class="row">
      <div class="col-md-2"></div>
      <div class="col-md-1">
        <h2><a id="nav-title" href="/">Onyx</a></h2>
      </div>
      <div class="col-md-1"></div>
      <div class="col-md-6">
        <ul class="nav nav-pills navbar-right">
          <li class="nav-choice" role="presentation"><a href="/learn">learn</a></li>
          <li class="nav-choice" role="presentation"><a href="/docs">docs</a></li>
          <li class="nav-choice" role="presentation"><a href="/tools">tools</a></li>
          <li class="nav-choice" role="presentation"><a href="/blog">blog</a></li>
          <li class="nav-choice" role="presentation"><a href="https://github.com/onyx-platform/onyx">github</a></li>
          <li class="nav-choice" role="presentation"><a href="/support">support</a></li>
          <li class="nav-choice" role="presentation"><a href="/team">team</a></li>
        </ul>
      </div>
      <div class="col-md-2"></div>
    </div>
  </div>
</header>

    <div class="container-fluid">
  <div class="row">
    <div class="col-md-2 panel page-contents">
      <h4>Contents</h4>
      <ul>
  <li><a href="/docs/cheat-sheet/0.8.8">cheat sheet</a></li>
  <li><a href="/docs/api/0.8.8">api docs</a></li>
  <li>user guide</li>
  <ul>
    
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/aggregation-state-management.html">Aggregation and State</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/apis.html">APIs</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/architecture-low-level-design.html">Architecture</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/backpressure.html">Backpressure</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/concepts.html">Concepts</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/core-async-plugin.html">core.async Plugin</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/deployment.html">Deployment</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/environment.html">Environment</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/examples.html">Examples</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/faq.html">FAQ</a></li>
    
    
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/flow-conditions.html">Flow Conditions</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/functions.html">Functions</a></li>
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/information-model.html">Information Model</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/lifecycles.html">Lifecycles</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/logging.html">Logging</a></li>
    
    
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/messaging.html">Messaging</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/monitoring.html">Monitoring</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/peer-config.html">Peer Configuration</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/performance-tuning.html">Performance Tuning</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/plugins.html">Plugins</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/production-check-list.html">Production Checklist</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/scheduling.html">Scheduling</a></li>
    
    
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/subscription.html">Subscription</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/testing-onyx-jobs.html">Testing Onyx Jobs</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/triggers.html">Triggers</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/what-does-it-offer.html">What does it Offer?</a></li>
    
    
    
    <li class="docs-section"><a href="/docs/user-guide/0.8.8/windowing.html">Windowing</a></li>
    
    
  </ul>
</ul>

    </div>
    <div class="col-md-1"></div>
    <div class="col-md-7 panel">
      <h2 id="logging">Logging</h2>

<p>This chapter details how to inspect and modify the logs that Onyx produces.</p>

<h3 id="timbre">Timbre</h3>

<p>Onyx uses <a href="https://github.com/ptaoussanis/timbre">Timbre</a> for
logging.</p>

<p>By default, all Onyx output is logged to a file called <code>onyx.log</code> in
the same directory as where the peer or coordinator jar is
executing. The logging configuration can be overridden completely, see
below.</p>

<p>Onyx&#39;s default logging configuration writes all <code>WARN</code> and <code>FATAL</code>
messages to standard out, also.</p>

<h4 id="overriding-the-log-file-name-and-path">Overriding the log file name and path</h4>

<p>In order to override the log file location add <code>:onyx.log/file</code> to
both the environment config sent into <code>start-env</code> as well as the
peer config sent into <code>start-peer-group</code>.</p>

<p>Both relative and absolute paths are supported by Timbre.</p>

<h4 id="overriding-the-timbre-log-config">Overriding the Timbre log config</h4>

<p>Similarly, to override the full Timbre log config map, construct the
Timbre configuration and add it to both the environment and peer
config maps under the <code>:onyx.log/config</code> key.  Note that the
<code>onyx.log/config</code> map will be merged with the existing Timbre
configuration rather than replacing it completely.  In practice this
means that extra configuration must be sent in to, for example,
disable appenders that are enabled by default.  See the examples
below.</p>

<h4 id="examples">Examples</h4>

<p>The following example simply changes the output file.</p>
<div class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">log-config</span> <span class="p">{</span><span class="ss">:onyx.log/file</span> <span class="s">&quot;/var/log/onyx.log&quot;</span><span class="p">}</span>
      <span class="nv">peer-config</span> <span class="p">(</span><span class="nb">merge </span><span class="nv">my-peer-config</span> <span class="nv">log-config</span><span class="p">)</span>
      <span class="nv">env-config</span> <span class="p">(</span><span class="nb">merge </span><span class="nv">my-env-config</span> <span class="nv">log-config</span><span class="p">)]</span>
  <span class="p">(</span><span class="nf">onyx.api/start-env</span> <span class="nv">env-config</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">onyx.api/start-peer-group</span> <span class="nv">peer-config</span><span class="p">)</span>

  <span class="c1">;; ...</span>
  <span class="p">)</span>
</code></pre></div>
<p>This example uses Timbre to redirect Onyx logs into the regular Java
logging system using the
<a href="https://github.com/palletops/log-config">log-config</a> library.</p>
<div class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="nf">require</span> <span class="o">&#39;</span><span class="p">[</span><span class="nv">com.palletops.log-config.timbre.tools-logging</span> <span class="ss">:as</span> <span class="nv">tl</span><span class="p">])</span>
<span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">log-config</span> <span class="p">{</span><span class="ss">:onyx.log/config</span> <span class="p">{</span><span class="ss">:appenders</span>
                                    <span class="p">{</span><span class="ss">:spit</span> <span class="p">{</span><span class="ss">:enabled?</span> <span class="nv">false</span><span class="p">}</span>
                                     <span class="ss">:standard-out</span> <span class="p">{</span><span class="ss">:enabled?</span> <span class="nv">false</span><span class="p">}</span>
                                     <span class="ss">:rotor</span> <span class="p">{</span><span class="ss">:enabled?</span> <span class="nv">false</span><span class="p">}</span>
                                     <span class="ss">:jl</span> <span class="p">(</span><span class="nf">tl/make-tools-logging-appender</span>
                                          <span class="p">{</span><span class="ss">:enabled?</span> <span class="nv">true</span>
                                           <span class="ss">:fmt-output-opts</span> <span class="p">{</span><span class="ss">:nofonts?</span> <span class="nv">true</span><span class="p">}})}</span>
                                    <span class="ss">:min-level</span> <span class="ss">:trace</span><span class="p">}}</span>
      <span class="nv">peer-config</span> <span class="p">(</span><span class="nb">merge </span><span class="nv">my-peer-config</span> <span class="nv">log-config</span><span class="p">)</span>
      <span class="nv">env-config</span> <span class="p">(</span><span class="nb">merge </span><span class="nv">my-env-config</span> <span class="nv">log-config</span><span class="p">)]</span>
  <span class="p">(</span><span class="nf">onyx/start-env</span> <span class="nv">env-config</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">onyx/start-peer-group</span> <span class="nv">peer-config</span><span class="p">)</span>

  <span class="c1">;; ...</span>
  <span class="p">)</span>
</code></pre></div>
<p>If you already have timbre logging configured somewhere in your code base,
you can specify <code>:onyx.log/config {}</code> to ensure your settings remain unchanged.
In effect, this simply merges in the empty map into whatever settings you may
have already specified for logging.</p>
<div class="highlight"><pre><code class="language-clojure" data-lang="clojure"><span class="p">(</span><span class="k">let </span><span class="p">[</span><span class="nv">log-config</span> <span class="p">{</span><span class="ss">:onyx.log/config</span> <span class="p">{}}</span>
      <span class="nv">peer-config</span> <span class="p">(</span><span class="nb">merge </span><span class="nv">my-peer-config</span> <span class="nv">log-config</span><span class="p">)</span>
      <span class="nv">env-config</span> <span class="p">(</span><span class="nb">merge </span><span class="nv">my-env-config</span> <span class="nv">log-config</span><span class="p">)]</span>
  <span class="p">(</span><span class="nf">onyx.api/start-env</span> <span class="nv">env-config</span><span class="p">)</span>
  <span class="p">(</span><span class="nf">onyx.api/start-peer-group</span> <span class="nv">peer-config</span><span class="p">)</span>

  <span class="c1">;; ...</span>
  <span class="p">)</span>
</code></pre></div>
<p>See the Timbre
<a href="https://github.com/ptaoussanis/timbre#configuration">example configuration</a>
for more information on valid values for the <code>:onyx.log/config</code> map.</p>

    </div>
  </div>
</div>


    <footer class="site-footer">

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <small><center>Copyright © Distributed Masonry 2016</center></small>
    </div>

  </div>

</footer>

  </body>

</html>
